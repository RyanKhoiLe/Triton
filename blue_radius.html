<!DOCTYPE HTML>
<html>
<head>
  <title>Guernica - Picasso</title>
  <meta charset="UTF-8">
  <link rel="stylesheet" type="text/css" href="tritonCSS.css">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
       <link rel="icon" href="images/tritonIconSmall.png">
       <script src="https://www.gstatic.com/firebasejs/3.2.1/firebase.js"></script>
</head>
<body>

  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyCVFksGcDoYDk23wAG58XdYdfyDL7urzUY",
      authDomain: "learnfirebase-43e98.firebaseapp.com",
      databaseURL: "https://learnfirebase-43e98.firebaseio.com",
      storageBucket: "learnfirebase-43e98.appspot.com",
    };
    firebase.initializeApp(config);
    var url = "https://learnfirebase-43e98.firebaseio.com";
    var firebaseRef = firebase.database().ref();
    var userComments = [];
    //var provider = new firebase.auth.FacebookAuthProvider();
    //firebase.auth().signInWithRedirect(provider);
    // firebase.auth().getRedirectResult().then(function(result) {
    //   if(result.credential){
    //     var token = result.credentil.accessToken;
    //   }
    //   var user = result.user;
    // }).catch(function(error) {
    //   var errorCode = error.code;
    //   var errorMessage = error.message;
    //   var email = error.email;
    //   var credential = error.credential;
    // });

    function timeStamp(){
      var now = new Date();
      var date = [now.getMonth() + 1, now.getDate(), now.getFullYear()];
      var time = [now.getHours(), now.getMinutes()];
      var suffix = (time[0] < 12) ? "AM" : "PM";
      time[0] = (time[0] < 12) ? time[0] : time[0] - 12;

      for(var i = 1; i < 3; i++){
        if(time[i] < 10) {
          time[i] = "0" + time[i];
        }
      }

      return date.join("/") + ", " + time.join(":") + " " + suffix;
    }

    function postComment(){
      var name = document.getElementById("name").value,
      comment = document.getElementById("comment").value,
      time = timeStamp();
      var badWords = ["fuck", "shit", "cock", "dick", "pussy", "bitch", "ass", "<", ">"];
      for( var i = 0; i < badWords.length; i++){
        if(name.includes(badWords[i])){
          if(name.charAt(name.indexOf(badWords[i])) == 0){
            if(name.charAt(name.indexOf(badWords[i]) + 1) == ' ' || name.charAt(name.indexOf(badWords[i]) + 1) == ',' || name.charAt(name.indexOf(badWords[i]) + 1) == '.'){
              document.getElementById("comment").value += "\n I'm sorry, your name includes inappropriate language.";
              return;
            }
          }
          if(name.charAt(name.indexOf(badWords[i] - 1)) == " " && name.charAt(name.indexOf(badWords[i]) + badWords[i].length) == " "){
            document.getElementById("comment").value += "\n I'm sorry, your name includes inappropriate language.";
            return;
          }
          if(name.charAt(name.indexOf(badWords[i] - 1)) == " " && name.indexOf(badWords[i]) + badWords[i].length == name.length){
            document.getElementById("comment").value += "\n I'm sorry, your name includes inappropriate language.";
            return;
          }
        }
        if(comment.includes(badWords[i])){
          if(comment.charAt(comment.indexOf(badWords[i])) == 0){
            if(comment.charAt(comment.indexOf(badWords[i]) + 1) == ' ' || comment.charAt(comment.indexOf(badWords[i]) + 1) == ',' || comment.charAt(comment.indexOf(badWords[i]) + 1) == '.'){
              document.getElementById("comment").value += "\n I'm sorry, your comment includes inappropriate language.";
              return;
            }
          }
          if(comment.charAt(comment.indexOf(badWords[i] - 1)) == " " && comment.charAt(comment.indexOf(badWords[i]) + badWords[i].length) == " "){
            document.getElementById("comment").value += "\n I'm sorry, your comment includes inappropriate language.";
            return;
          }
          if(comment.charAt(comment.indexOf(badWords[i] - 1)) == " " && comment.indexOf(badWords[i]) + badWords[i].length == comment.length){
            document.getElementById("comment").value += "\n I'm sorry, your comment includes inappropriate language.";
            return;
          }
        }
      }

      if(name && comment){
        firebaseRef.push({
          name: name,
          comment: comment,
          time: time
        });
      }

      document.getElementById("name").value = '';
      document.getElementById("comment").value = '';
    }

    firebaseRef.on("child_added", function(snapshot){
      var comment = snapshot.val();
      addComment(comment.name, comment.comment, comment.time);
    });
    function UserComment(name, comment, timeStamp){
      this.name = name;
      this.comment = comment;
      this.timeStamp = timeStamp;
    }
    function addComment(name, comment, timeStamp){
      var userComment = new UserComment(name, comment, timeStamp);
      userComments.push(userComment);
      var comments = document.getElementById("comments");
      var num = '' + userComments.indexOf(userComment);
      if(userComments.indexOf(userComment) > 0){
        var numMinusOne = '' + userComments.indexOf(userComment);
      }
      comments.innerHTML.replace("<button id='shareBtn" + numMinusOne +"' class='shareBtns'>SHARE</button>", '');
      comments.innerHTML = "<hr><h4>" + name + " says:</h4> <p id='commentText'>" + comment +"<h3>" + timeStamp + "</h3>" +
      "<div class='fb-share-button' data-href='http://ryankhoile.github.io/Triton/exhibit1.html' data-layout='button' data-size='small' data-mobile-iframe='true'>" +
      "<a class='fb-xfbml-parse-ignore' target='_blank' href='https://www.facebook.com/dialog/feed?app_id=145634995501895&display=popup&amp;caption=I%20just%20went%20to%20the%20Triton%20Museum%20and%20it%20was%20amazing&link=https%3A%2F%2Fryankhoile.github.io%2FTriton%2Fexhibit1.html%2F&redirect_uri=https://ryankhoile.github.io/Triton/exhibit1.html'>Share</a></div>"
      + "<button id='shareBtn" + num + "' class='shareBtns'>SHARE</button>" + comments.innerHTML;
      console.log(userComments);
      console.log(document.getElementById("shareBtn" + num));
      document.getElementById("shareBtn" + num).onclick = function(){
        FB.ui({
          method: 'share',
          mobile_iframe: true,
          href: 'https://ryankhoile.github.io/Triton/exhibit1.html',
         quote: 'I just went to the Triton'
        }, function(response){});
      }
    }

    firebase.auth().signOut().then(function() {

    }, function(error){});
  </script>
  <div id="fb-root"></div>
  <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.7&appId=626508604175695";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>

  <div id="headBar">
    <h1 style="text-align: left"> GUERNICA - PICASSO </h1>
    <a href="index.html"><img id="logo" src="images/tritonIcon.png" alt="triton"></a>
  </div>

  <div id = "wrapper">
    <a href='ryankhoile.github.io/Triton/exhibit2.html'><img src='images/rightArrow.png'></a>
    <h2> Title: <strong> Blue Radius </strong> </h2>
    <h2> Artist: <strong> Susan Parker </strong> </h2>
    <h2> Year: <strong> 2013 </strong> </h2>
    <h2> Genre: <strong>  </strong> </h2>
    <h2> Material: <strong> Acrylic on Canvas </strong> </h2>
    <audio controls>
      <source src="audio/Guernica.mp3" type="audio/mpeg">
      No audio for this browser
    </audio>

    <hr>
    <img src="images/blue_radius.jpg" width="60%">
    <hr>
    <h2> Major Symbols </h2>
    <div class="centeredList">
      <ul>
        <li>X</li>
        <li>X</li>
        <li>X</li>
        <li>X</li>
        <li>X</li>
        <li>X</li>
        <li>X</li>
      </ul>
    </div>
    <hr>
    <h2> History of Blue Radius </h2>
      <p></p>
    <hr>
    <h2> History of Susan Parker </h2>
      <p></p>
    <hr>
    <h2> Video 1 </h2>
    <iframe class="video" src="https://www.youtube.com/embed/jc1Nfx4c5LQ" frameborder="0" allowfullscreen></iframe>
    <hr>
    <h2> Video 2 </h2>
    <iframe class="video" src="https://www.youtube.com/embed/PbLTE-ERzY0" frameborder="0" allowfullscreen></iframe>
    <hr>
    <h2> Related Works </h2>
    <a href="http://susanparkerpainter.com/susan_parker_paintings_tracery.html">Tracery One</a><br>
    <a href="http://susanparkerpainter.com/susan_parker_paintings_chart_compass.html"> Indigo </a>
    <hr>
     <a href="http://susanparkerpainter.com/"> <h3>More on Susan Parker</h3> </a>
     <button id="shareBtn" class="shareBtns">SHARE</button>
     <!-- <script>

      var shareButtons = document.getElementsByClassName("shareBtns");
      console.log(shareButtons.length);
      for(var i = 0; i < shareButtons.length; i++){
        shareButtons[i].onclick = function() {
          FB.ui({
            method: 'share',
            mobile_iframe: true,
            href: 'https://ryankhoile.github.io/Triton/exhibit1.html',
           quote: 'I just went to the Triton'
          }, function(response){});
        }
      }
      //  document.getElementById("shareBtn").onclick = function() {
      //    FB.ui({
      //      method: 'share',
      //      mobile_iframe: true,
      //      href: 'https://ryankhoile.github.io/Triton/exhibit1.html',
      //     quote: 'I just went to the Triton'
      //    }, function(response){});
      //  }
     </script> -->
     <div class='fb-share-button' data-href='http://ryankhoile.github.io/Triton/exhibit1.html' data-layout='button' data-size='small' data-mobile-iframe='true'>
     <a class='fb-xfbml-parse-ignore' target='_blank' href='https://www.facebook.com/dialog/feed?app_id=626508604175695&display=popup&amp;caption=I%20just%20went%20to%20the%20Triton%20Museum%20and%20it%20was%20amazing&link=https%3A%2F%2Fryankhoile.github.io%2FTriton%2Fexhibit1.html%2F&redirect_uri=https://ryankhoile.github.io/Triton/exhibit1.html'>Share</a></div>


     <div class="container">
       <div class="header"> <h2>Comment and Post to Facebook <h2></div>
       <div class="fb-comments" data-href="http://ryankhoile.github.io/Triton/exhibit1.html" data-width="100%" data-numposts="20"></div>
       <div class="comment-box">
         <div class="comment-form">
           <div class="header"> <h2> No Facebook? Add a comment here <h2></div>
           <form action="#" onsubmit="event.preventDefault(); postComment()">
             <div>
               <input type="text" id="name" placeholder="Name">
             </div>
             <div>
               <textarea id="comment" rows="3" cols="30" placeholder="Comment"></textarea>
             </div>
             <button type="submit">POST</button>
           </form>
         </div>
         <div id="commentContainer">
           <h4 class="header">Comments</h4>
           <div id="comments"></div>
         </div>
       </div>
     </div>
    <img src="images/tritonLogo.png" alt="triton" height="50" style="padding-top: 15px; padding-bottom: 0px;">
    <div><a href="http://ryankhoile.github.io/Triton/index.html">Return to main page</a></div>
  </div>
</body>

</html>
